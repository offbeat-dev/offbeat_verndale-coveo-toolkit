"use strict";(self.webpackChunk_verndale_toolkit=self.webpackChunk_verndale_toolkit||[]).push([[7546],{87546:function(d,c,s){s.r(c),s.d(c,{atomic_search_box_query_suggestions:function(){return _},atomic_search_box_recent_queries:function(){return f}});var r=s(51860),l=s(16507),i=s(7941),t=s(59002),n=s(29592),o=s(59348),u=s(30043),y=s(27663),E=s(29721);const _=class{constructor(e){(0,r.r)(this,e)}componentWillLoad(){try{(0,t.d)(e=>(this.bindings=e,this.initialize()),this.host)}catch(e){this.error=e}}renderIcon(){return this.icon||l.S}initialize(){const e=this.bindings.engine,{registerQuerySuggest:a,fetchQuerySuggestions:h}=(0,i.x)(e);return e.dispatch(a({id:this.bindings.id,count:this.bindings.numberOfQueries})),{position:Array.from(this.host.parentNode.children).indexOf(this.host),onInput:()=>e.dispatch(h({id:this.bindings.id})),renderItems:()=>this.renderItems()}}renderItems(){const a=this.bindings.searchBoxController.state.value!==""?this.maxWithQuery:this.maxWithoutQuery;return this.bindings.searchBoxController.state.suggestions.slice(0,a).map(h=>this.renderItem(h))}renderItem(e){const a=this.bindings.searchBoxController.state.value!=="";return{content:(0,r.h)("div",{class:"flex items-center"},this.bindings.getSuggestions().length>1&&(0,r.h)("atomic-icon",{icon:this.renderIcon(),class:"w-4 h-4 mr-2 shrink-0"}),a?(0,r.h)("span",{class:"break-all line-clamp-2",innerHTML:e.highlightedValue}):(0,r.h)("span",{class:"break-all line-clamp-2"},e.rawValue)),key:`qs-${(0,n.c)(e.rawValue)}`,query:e.rawValue,onSelect:()=>{this.bindings.searchBoxController.selectSuggestion(e.rawValue)}}}render(){if(this.error)return(0,r.h)("atomic-component-error",{element:this.host,error:this.error})}get host(){return(0,r.g)(this)}},S='<svg fill="none" stroke="currentColor" stroke-linejoin="round" stroke-linecap="round"  viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><circle cx="8" cy="8" r="7.5"/><path d="m8.5 4.5v4"/><path d="m10.3066 10.1387-1.80932-1.5768"/></svg>',f=class{constructor(e){(0,r.r)(this,e),this.maxWithQuery=3,this.warnUser=(0,o.o)(()=>this.bindings.engine.logger.warn("Because analytics are disabled, the recent queries feature is deactivated."))}componentWillLoad(){try{(0,t.d)(e=>(this.bindings=e,this.initialize()),this.host)}catch(e){this.error=e}}renderIcon(){return this.icon||S}initialize(){return this.storage=new u.a,this.recentQueriesList=(0,i.S)(this.bindings.engine,{initialState:{queries:this.retrieveLocalStorage()},options:{maxLength:1e3}}),this.recentQueriesList.subscribe(()=>this.updateLocalStorage()),{position:Array.from(this.host.parentNode.children).indexOf(this.host),renderItems:()=>this.renderItems()}}retrieveLocalStorage(){return this.storage.getParsedJSON(u.S.RECENT_QUERIES,[])}updateLocalStorage(){return this.recentQueriesList.state.analyticsEnabled?this.storage.setJSON(u.S.RECENT_QUERIES,this.recentQueriesList.state.queries):this.disableFeature()}disableFeature(){this.warnUser(),this.storage.removeItem(u.S.RECENT_QUERIES)}renderItems(){if(!this.recentQueriesList.state.analyticsEnabled)return[];const e=this.bindings.searchBoxController.state.value,h=e!==""?this.maxWithQuery:this.maxWithoutQuery,m=this.recentQueriesList.state.queries.filter(g=>g!==e&&g.toLowerCase().startsWith(e.toLowerCase())).slice(0,h).map(g=>this.renderItem(g));return m.length&&m.unshift(this.renderClear()),m}renderClear(){return{key:"recent-query-clear",content:(0,r.h)("div",{class:"flex justify-between w-full"},(0,r.h)("span",{class:"font-bold",part:"recent-query-title"},this.bindings.i18n.t("recent-searches")),(0,r.h)("span",{part:"recent-query-clear"},this.bindings.i18n.t("clear"))),onSelect:()=>{this.recentQueriesList.clear(),this.bindings.triggerSuggestions()}}}renderItem(e){const a=this.bindings.searchBoxController.state.value;return{key:`recent-${(0,n.c)(e)}`,query:e,content:(0,r.h)("div",{class:"flex items-center break-all"},(0,r.h)("atomic-icon",{icon:this.renderIcon(),class:"w-4 h-4 mr-2 shrink-0"}),a===""?(0,r.h)("span",{class:"break-all line-clamp-2"},e):(0,r.h)("span",{class:"break-all line-clamp-2",innerHTML:i.y.highlightString({content:e,openingDelimiter:'<span class="font-bold">',closingDelimiter:"</span>",highlights:[{offset:a.length,length:e.length-a.length}]})})),onSelect:()=>{if(this.bindings.isStandalone){this.bindings.searchBoxController.updateText(e),this.bindings.searchBoxController.submit();return}this.recentQueriesList.executeRecentQuery(this.recentQueriesList.state.queries.indexOf(e))}}}render(){if(this.error)return(0,r.h)("atomic-component-error",{element:this.host,error:this.error})}get host(){return(0,r.g)(this)}}},30043:function(d,c,s){s.d(c,{S:function(){return r},a:function(){return l}});var r;(function(i){i.RECENT_QUERIES="coveo-recent-queries",i.STANDALONE_SEARCH_BOX_DATA="coveo-standalone-search-box-data"})(r||(r={}));class l{constructor(){}clear(){return this.tryAccessLocalStorageOrWarn(()=>localStorage.clear(),()=>{})}getItem(t){return this.tryAccessLocalStorageOrWarn(()=>localStorage.getItem(t),()=>null)}getParsedJSON(t,n){const o=this.getItem(t);return o?this.tryJSONOrWarn(t,()=>JSON.parse(o),()=>n):n}key(t){return this.tryAccessLocalStorageOrWarn(()=>localStorage.key(t),()=>null)}get length(){return this.tryOrElse(()=>localStorage.length,()=>0)}removeItem(t){return this.tryAccessLocalStorageOrWarn(()=>localStorage.removeItem(t),()=>{})}setItem(t,n){return this.tryAccessLocalStorageOrWarn(()=>localStorage.setItem(t,n),()=>{})}setJSON(t,n){const o=this.tryJSONOrWarn(t,()=>JSON.stringify(n),()=>JSON.stringify({}));return this.setItem(t,o)}tryAccessLocalStorageOrWarn(t,n){return this.tryOrElse(t,()=>(console.warn("Error while trying to read or modify local storage. This can be caused by browser specific settings."),n()))}tryJSONOrWarn(t,n,o){return this.tryOrElse(n,()=>(console.warn(`Error while trying to do JSON manipulation with local storage entry. ${t}`),o()))}tryOrElse(t,n){try{return t()}catch(o){return console.warn(o),n()}}}},16507:function(d,c,s){s.d(c,{S:function(){return r}});const r='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="m6.4 0c3.5 0 6.4 2.9 6.4 6.4 0 1.4-.4 2.7-1.2 3.7l4 4c.4.4.4 1 .1 1.5l-.1.1c-.2.2-.5.3-.8.3s-.6-.1-.8-.3l-4-4c-1 .7-2.3 1.2-3.7 1.2-3.4-.1-6.3-3-6.3-6.5s2.9-6.4 6.4-6.4zm0 2.1c-2.3 0-4.3 1.9-4.3 4.3s1.9 4.3 4.3 4.3 4.3-1.9 4.3-4.3-1.9-4.3-4.3-4.3z"/></svg>'},29592:function(d,c,s){s.d(c,{c:function(){return l},r:function(){return r}});function r(i){return i.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}function l(i){var t;return(t=i.match(/(\d|\w|\s)+/g))===null||t===void 0?void 0:t.join("").replace(/\s/g,"-").toLocaleLowerCase()}}}]);

//# sourceMappingURL=7546.bundle.js.map